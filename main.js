(()=>{"use strict";const t=[{password:"anVsaWUxMQ==",facts:["Her name is Julie Williams.","Lives in Perth, Western Australia.","She has a dog, called Max.","She is born on 12 February 2011."]},{password:"c2VjcmV0",facts:["His name is Andrew","He lives in Sydney, Australia","He loves riding his mountain bike","He has 2 brothers"]},{password:"c3VyZjE0",facts:["His name is Nathan","He is born on the 14 Avril 2005"],images:["/assets/nathan.jpg"]},{password:"aG9ja2V5MTA=",facts:["Her name is Jessica","She plays hockey","She was state champion year 10!"]},{password:"U21va2VZ",facts:["Elsa has a cat called Smokey","She is in year 5","She was born in New Zealand"]}],e=new class{events;constructor(){this.events={}}on(t,e){this.events[t]||(this.events[t]=[]),this.events[t]?.push(e)}emit(t,e){const s=this.events[t];if(void 0!==s)for(let t of s)t(e)}};function s(t){if(!t)throw new Error("assertion error")}function n(t,e=document){const s=e.querySelector(t);if(null===s)throw new Error(`selector ${t} returned null`);return s}async function a(t){return new Promise((e=>{setTimeout((()=>e()),t)}))}class o{elements;constructor(){this.elements={factsList:n("#facts-list"),imagesList:n("#images-list")},e.on("set-case",(e=>{s(e>=0),s(e<t.length);const n=t[e];this._displayData(n)}))}_displayData(t){if(this.elements.factsList.innerHTML="",this.elements.imagesList.innerHTML="",t.images)for(let e of t.images){const t=document.createElement("li"),s=document.createElement("img");s.src=e,t.appendChild(s),this.elements.imagesList.appendChild(t)}for(let e of t.facts){const t=document.createElement("li");t.textContent=e,this.elements.factsList.appendChild(t)}}}class i{elements;index;constructor(){this.elements={before:n("#case-before"),after:n("#case-after"),number:n("#case-number"),total:n("#case-total")},this.index=0,this.elements.total.textContent=t.length.toString(),e.on("set-case",(e=>{this.index=e,this.elements.before.disabled=0===e,this.elements.after.disabled=e===t.length-1,this.elements.number.textContent=(this.index+1).toString()})),this.elements.before.addEventListener("click",(t=>{e.emit("set-case",this.index-1)})),this.elements.after.addEventListener("click",(t=>{e.emit("set-case",this.index+1)}))}}const r={failure:"✗",success:"✓",info:"ⓘ"};class l{elements;constructor(t){const[e,s,n]=this._makeHtml(t);this.elements={box:t,symbol:e,message:s,close:n},this.elements.close.addEventListener("click",this.hide)}show=(t,e)=>{this.elements.box.classList.remove("hidden"),this.elements.box.setAttribute("data-alert-type",t),this.elements.symbol.textContent=r[t],this.elements.message.innerHTML=e};toggle=(t,e)=>{this.elements.box.classList.contains("hidden")?this.show(t,e):this.hide()};hide=()=>{e.emit("alert-close",this),this.elements.box.classList.add("hidden")};_makeHtml(t){t.classList.add("hidden","alertbox");const e=document.createElement("span");e.classList.add("alertbox-symbol");const s=document.createElement("span");s.classList.add("alertbox-message");const n=document.createElement("button");return n.type="button",n.classList.add("alertbox-close"),n.innerHTML="&times;",t.appendChild(e),t.appendChild(s),t.appendChild(n),[e,s,n]}}const h="<>?,./!@#$%^&*() _+-=~`{}[]:\";'",c=String.raw`
features:
  - \d: replaces with digits between 0-9 inclusive
  - \sX: try with lower and upper case X
  - \p: try with punctuation symbols
  - \\: literal backslash

Punctuation symbols: ${h}

Examples:
  - liam\d -> {liam0, liam1, liam2, ..., liam9}
  - \sliam -> {liam, Liam}
  - liam\p -> {liam!, liam<, liam>, ..., liam"}
`;class d{buf;buflength;parsedPattern;generating;opt;constructor(){this.buf=new Array(4096),this.buflength=0,this.parsedPattern=[],this.opt={swapcase:!1},this.generating=!1}setOption(t,e){if(this.generating)throw new Error("finish consuming generator first");this.opt[t]=e}numberOfPermutations(t){let e=1;for(let s of this.parsedPattern){const n=this.expandPartLength(s);e*=n,t&&t.push(n)}return e}*generate(){const t=[],e=this.numberOfPermutations(t);this.buflength=this.parsedPattern.length,this.generating=!0;t:for(let s=0;s<e;s++){let e=1;for(let n=this.parsedPattern.length-1;n>=0;n--)this.buf[n]=this.expandPartIth(this.parsedPattern[n],Math.floor(s/e)%t[n]),e*=t[n];const n=this.buf.slice(0,this.buflength).join("");try{yield n}catch(t){break t}}this.generating=!1}setPattern(t){if(this.generating)throw new Error("finish consuming generator first");try{this.parse(t)}catch(t){if(t instanceof m)return t.message;throw t}return null}parse(t){const e=t.split(""),s=()=>{if(n())throw new m("Unexpected end of pattern");return e.shift()},n=()=>0===e.length;for(this.parsedPattern.length=0;!n();){const t=s();if("\\"===t){const t=s();if("\\"===t)this.parsedPattern.push("\\");else if("d"===t||"p"===t)this.parsedPattern.push(`\\${t}`);else{if("s"!==t)throw new m(`Unknown command '\\${t}'`);{const t=s();if(!u(t))throw new m(`\\sX, X should be a letter, got '${t}'`);this.parsedPattern.push(`\\s${t}`)}}}else this.parsedPattern.push(t)}}expandPartLength(t){return 1===t.length&&u(t)&&this.opt.swapcase?2:"\\p"===t?h.length:"\\d"===t?10:t.startsWith("\\s")?2:1}expandPartIth(t,e){if(1===t.length&&u(t)&&this.opt.swapcase){if(0===e)return t.toLowerCase();if(1===e)return t.toUpperCase()}if("\\p"===t)return h[e];if("\\d"===t)return String.fromCharCode(e+"0".charCodeAt(0));if(t.startsWith("\\s")){if(0===e)return t[t.length-1].toLowerCase();if(1===e)return t[t.length-1].toUpperCase()}return t}}class m extends Error{}function u(t){const e=t.charCodeAt(0);return"a".charCodeAt(0)<=e&&e<="z".charCodeAt(0)||"A".charCodeAt(0)<=e&&e<="Z".charCodeAt(0)}class p{elements;alerts;caseIndex;state;ps;stopAnimation;constructor(t){this.elements={form:n("#tools-pattern-form",t),fieldset:n("#tools-pattern-fieldset",t),pattern:n("#tools-pattern",t),helpBtn:n("#tools-pattern-helpbtn",t),swapcase:n("#tools-swap-case",t),statusBar:n("#tools-pattern-status",t),cancelBtn:n("#tools-pattern-cancel")},this.alerts={help:new l(n("#tools-pattern-help",t)),parseError:new l(n("#tools-pattern-parseerror",t)),result:new l(n("#tools-pattern-result",t))},this.ps=new d,this.state="idle",this.stopAnimation=!1,this.bindDOM(),this.updatePattern(),this.caseIndex=0,e.on("set-case",(t=>{this.caseIndex=t}))}bindDOM(){this.elements.helpBtn.addEventListener("click",(()=>{this.alerts.help.toggle("info",`<pre>${c}</pre>`)})),this.elements.cancelBtn.classList.add("hidden"),this.elements.cancelBtn.addEventListener("click",(()=>{this.stopAnimation=!0})),this.elements.pattern.addEventListener("input",this.updatePattern),this.ps.setOption("swapcase",this.elements.swapcase.checked),this.elements.swapcase.addEventListener("change",(t=>{this.ps.setOption("swapcase",this.elements.swapcase.checked),this.updateStatusBarForIdleAndError()})),this.elements.form.addEventListener("submit",(async e=>{e.preventDefault(),this.state="running",this.lock(),this.alerts.result.hide(),this.elements.cancelBtn.classList.remove("hidden");const s=atob(t[this.caseIndex].password),n=await this.runPasswordAnimation(s);this.unlock(),this.state="idle",this.elements.cancelBtn.classList.add("hidden"),this.stopAnimation=!1,"found"===n?this.alerts.result.show("success",`Password is ${s}`):"not found"===n&&this.alerts.result.show("failure","Password not found"),this.updateStatusBarForIdleAndError()}))}lock(){this.elements.fieldset.disabled=!0,e.emit("lock",void 0)}unlock(){this.elements.fieldset.disabled=!1,e.emit("unlock",void 0)}async runPasswordAnimation(t){let e=1;const s=this.ps.numberOfPermutations(),n=this.ps.generate();for(let o of n){if(this.elements.statusBar.textContent=`${e}/${s}: trying "${o}"`,this.stopAnimation)return n.throw(null),this.stopAnimation=!1,"canceled";if(await a(50),o===t)return n.throw(null),"found";e++}return"not found"}updatePattern=()=>{if("running"===this.state)throw new Error("cannot update pattern whilst running");const t=this.ps.setPattern(this.elements.pattern.value);null!==t?(this.alerts.parseError.show("failure",t),this.state="errored"):(this.alerts.parseError.hide(),this.state="idle"),this.updateStatusBarForIdleAndError()};updateStatusBarForIdleAndError(){let t;if("idle"===this.state){const e=this.ps.numberOfPermutations();t=`${e} permutations, takes about ${function(t){const e=t%1e3;t/=1e3;const s=Math.floor(t)%60;t/=60;const n=Math.floor(t)%60;t/=60;const a=Math.floor(t)%24;t/=24;const o=Math.floor(t)%365;t/=365;const i=Math.floor(t)%1e3;t/=1e3;const r=Math.floor(t)%4543e3;t/=4543e3;const l=Math.floor(t);let h=[];return l>1&&h.push(`${l}earth life spans`),1===l&&h.push(`${l}earth life span`),r>1&&h.push(`${r}milleniums`),1===r&&h.push(`${r}millenium`),i>1&&h.push(`${i}years`),1===i&&h.push(`${i}year`),o>1&&h.push(`${o}days`),1===o&&h.push(`${o}day`),a>0&&h.push(`${a}h`),n>0&&h.push(`${n}min`),s>0&&h.push(`${s}s`),e>0&&h.push(`${e}ms`),h.slice(0,2).join(" ")}(50*e)}`}else"errored"===this.state?t="check errors":s(!1);this.elements.statusBar.textContent=t}}class f{root;selectedID;tabs;constructor(t){this.root=t,this.tabs={},this.selectedID=this.queryTabsFromHTML(),this.bindDOM()}activate(t){if(!(t in this.tabs))throw new Error(`unknown tabID ${t}`);this.tabs[this.selectedID].handle.classList.remove("tab-selected"),this.tabs[this.selectedID].content.classList.remove("tab-selected"),this.selectedID=t,this.tabs[this.selectedID].handle.classList.add("tab-selected"),this.tabs[this.selectedID].content.classList.add("tab-selected")}bindDOM(){for(let t of Object.keys(this.tabs))this.tabs[t].handle.addEventListener("click",(e=>{e.preventDefault(),this.activate(t)}))}queryTabsFromHTML(){const t={};this.root.querySelectorAll("[data-open-tab]").forEach((e=>{const n=e.getAttribute("data-open-tab");if(s(null!==n),n in t)throw new Error(`duplicate tabID ${n}`);e.classList.remove("tab-selected"),t[n]={handle:e}})),this.root.querySelectorAll("[data-tab-id]").forEach((e=>{const n=e.getAttribute("data-tab-id");if(s(null!==n),!(n in t))throw new Error(`No tab handle for ${n}`);e.classList.remove("tab-selected"),t[n].content=e}));for(let e of Object.keys(t)){const s=t[e].content,n=t[e].handle;if(void 0===n||void 0===s)throw new Error(`incomplete handle/content tab pair for ${e}`);this.tabs[e]={content:s,handle:n}}const e=this.root.getAttribute("data-tab-initial");if(null===e)throw new Error("no default tab selected. Set the data-tab-initial attribute on the root element");if(!(e in this.tabs))throw new Error(`initial tab ${e} doesn't exists`);return this.tabs[e].handle.classList.add("tab-selected"),this.tabs[e].content.classList.add("tab-selected"),e}}class w{elements;caseIndex;commonPasswords;alerts;constructor(a){this.commonPasswords=a,this.elements={manualTry:n("#tools-manual-try"),manualTryForm:n("#tools-manual-try-form"),tryCommon:n("#tools-try-common"),explainCommon:n("#tools-explain-common"),commonStatusBar:{bar:n("#tools-try-common-status"),index:n("#tools-try-common-index"),total:n("#tools-try-common-total"),current:n("#tools-try-common-current")}},new p(n("[data-tab-id='strategy-pattern']")),this.caseIndex=0,this.alerts={manualTry:new l(n("#tools-manual-try-alert")),commonPasswords:new l(n("#tools-common-passwords-result")),commonPasswordsHelp:new l(n("#tools-common-passwords-help"))},this.elements.commonStatusBar.total.textContent=a.length.toString(),new f(n(".tab-section",n("#tools"))),this.alerts.commonPasswordsHelp.show("info",b),e.on("set-case",(e=>{s(e>=0),s(e<t.length),this.caseIndex=e,this.alerts.manualTry.hide(),this.alerts.commonPasswords.hide(),this.elements.manualTryForm.reset()})),this.elements.manualTryForm.addEventListener("submit",(e=>{e.preventDefault();const s=function(t){const e=document.createElement("span");return e.textContent=t,e.innerHTML}(this.elements.manualTry.value);t[this.caseIndex].password===btoa(this.elements.manualTry.value)?this.alerts.manualTry.show("success","Yep, that's the password!"):this.alerts.manualTry.show("failure",`Nope, <i>${s}</i> isn't correct.`)})),e.on("alert-close",(t=>{t===this.alerts.commonPasswords&&this.elements.commonStatusBar.bar.classList.add("hidden")})),this.elements.tryCommon.addEventListener("click",(async e=>{this.alerts.commonPasswords.hide(),this.elements.commonStatusBar.bar.classList.remove("hidden"),this.elements.tryCommon.disabled=!0;const s=atob(t[this.caseIndex].password);await this.runCommonPasswordsAnimation(s)?this.alerts.commonPasswords.show("success",`Found the password! It's <i>${s}</i>`):this.alerts.commonPasswords.show("failure","Nah, couldn't find the password"),this.elements.tryCommon.disabled=!1})),this.elements.explainCommon.addEventListener("click",(t=>{t.preventDefault(),this.alerts.commonPasswordsHelp.toggle("info",b)}))}async runCommonPasswordsAnimation(t){let e=1;for(let s of this.commonPasswords){if(this.elements.commonStatusBar.index.textContent=e.toString(),this.elements.commonStatusBar.current.textContent=s,await a(50),s===t)return!0;e++}return!1}}const b='<p>Some passwords are used a lot, like\n<i>123456</i>, <i>superman</i> or <i>qwerty</i>. So hackers have made lists of\nthe most common passwords, and then test them all when trying to break into your\naccount.</p>\n\n<p>\n<a href="https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Common-Credentials/10-million-password-list-top-10000.txt">Some</a>\n<a href="https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Common-Credentials/10k-most-common.txt">lists</a>\n<a href="https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Common-Credentials/10-million-password-list-top-1000000.txt">are</a>\n<a href="https://raw.githubusercontent.com/DavidWittman/wpxmlrpcbrute/master/wordlists/1000-most-common-passwords.txt">publicly</a>\navailable.\n</p>\n\n<p>\nThis button tests every single password in <a href="assets/common-passwords-list.txt">this list</a>.\n</p>\n',g=fetch("/assets/common-passwords-list.txt").then((t=>t.text())).then((t=>t.split(/\n/g)));document.addEventListener("DOMContentLoaded",(()=>{g.then((t=>{new w(t),new o,new i,e.emit("set-case",0)}))}))})();